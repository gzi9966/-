---

---

> # 系列文章目录
> @[TOC](目录)
>

---



---

# 一、设计要求
本设计要求在MATLAB平台上构建并仿真无线多径信道模型，旨在真实地再现信号在复杂传播环境中的多路径效应以及相应的衰落、延迟和噪声干扰特性。设计需基于预设的各抽头延迟与功率增益参数，采用Rayleigh衰落模型生成信道系数，每个抽头均利用复正态分布构造，经过dB到线性功率的转换，确保模型反映出不同路径信号能量的衰减特性。同时，系统必须引入加性高斯白噪声（AWGN），以模拟实际无线环境中不可避免的噪声干扰，噪声功率及其统计特性应依据仿真需求灵活调整。为便于直观观察信道特性，设计要求提供多视角可视化功能，包括时间域、频率域的三维曲面图以及各信道抽头信号幅值的统计直方图，从而全面展示信道在时变性和频谱扩展方面的表现。此外，系统应支持修改延迟和功率等关键参数，利用参数调整探讨类似于反磁性（diamagnetic）现象中信号屏蔽、散射或排斥效应在不同场景下的影响，增强模型对特殊环境下表现的逼真性。最后，要求将原始及经过参数修改仿真的信道数据模块化存储，便于后续数据分析及系统优化，实现理论验证与实验数据的无缝衔接，满足复杂无线通信环境下对信道建模精度与扩展性的双重要求。

抽头延迟线多径信道建模，生成信道系数矩阵，并绘制信道传递函数时间、频率、幅值三维曲面图，及单抽头信道系数统计直方图，改变参数，观察图形变化并分析，测试信道模型参数可参考课本IMT2000信道。



![](https://i-blog.csdnimg.cn/direct/882bd0f8e44e419e89cd8205b5025b48.png)



---

# 二、设计思路
## 1. 设计思路
1. **参数设置与信道建模**  
    - **信道参数设定**：通过设置延迟（`delay`）和对应的功率增益（`power`）来模拟多径效应；这些参数决定了各个抽头的延迟和衰减情况。  
    - **采样参数设定**：定义采样点数 `N` 以及采样频率 `Fs`，构造时间向量 `t`，以便后续绘图和频率域分析。
2. **信道系数生成**  
    - 根据每个抽头的功率，将 Rayleigh 衰落过程作为信道系数生成：利用高斯随机变量 (randn) 生成复数信道系数，并对其进行幅值缩放（利用 dB 到线性功率转换），构造信道系数矩阵 `H`。
    - 加入噪声：通过生成具有指定噪声功率的复数高斯噪声，将噪声加到信道系数上，形成带噪信道模型 `H_noisy`。
3. **信道响应分析与绘图**  
    - **时间域绘制**：利用 `mesh` 绘制出随时间变化的各抽头信道系数幅值，直观显示信道在时域的多径特性。
    - **频率域绘制**：采用 FFT 变换计算频率响应，并通过 `mesh` 展示频率域下信道传递函数的幅值分布。
    - **统计直方图**：针对某一抽头（例如第一个抽头）的信道系数幅值绘制直方图，观察其统计分布情况。
4. **参数修改与对比**  
    - 改变延迟和功率参数（`delay_new` 与 `power_new`），重新生成信道模型，并绘制新的时域图，以便比较参数变化对信道特性的影响。
5. **数据保存**  
    - 将原始和修改后的信道数据保存到 MAT 文件中，便于后续分析和复现。



![](https://i-blog.csdnimg.cn/direct/fbda81f40e614561b3da08fb54faba11.png)

---

## 2. 关键代码模块解析
### 2.1 参数设置与时间向量构造
```matlab
% 参数设置
delay = [0, 1e-6, 2e-6, 3e-6, 4e-6];  % 各抽头延迟
power = [0, -3, -6, -9, -12];  % 各抽头功率增益 (dB)
N = 1000;  % 采样点数
Fs = 1e6;  % 采样频率
t = (0:N-1)/Fs;  % 时间向量

```

**说明：**  

+ 这里定义了多径信道中各路径的延迟和功率。功率以 dB 为单位，后续会转换为线性值。
+ 采样点数和采样频率定义了信号的基本采样条件，进而生成了时间向量 `t`，用于绘图。

---

### 2.2 信道系数生成与噪声加入
```matlab
% 生成信道系数矩阵
H = zeros(length(delay), N);
for i = 1:length(delay)
    H(i, :) = sqrt(10^(power(i)/10)) * (randn(1, N) + 1i*randn(1, N))/sqrt(2);
end

% 此处略去至少10行代码

```

**说明：**

+ **信道系数矩阵 **`H`：每个抽头生成一个复数随机序列，模拟 Rayleigh 衰落。乘以 `sqrt(10^(power(i)/10))` 实现了对各抽头不同功率的调整。
+ **噪声加入**：类似方法生成相同维度的噪声矩阵，并按照噪声功率进行幅值缩放，然后与信道系数相加，得到带噪信道 `H_noisy`。

---

### 2.3 信道传递函数的绘制
1. **时域响应绘图**  

```matlab
subplot(2, 2, 1);
mesh(t, 1:length(delay), abs(H_noisy));
xlabel('时间 (s)');
ylabel('抽头');
zlabel('幅值');
title('信道传递函数 (时间, 幅值)');
```

**说明：**  

    - 使用 `mesh` 绘制出每个抽头随时间变化的幅值图，直观展示信道响应在时间域上的特性。
2. **频域响应绘图**  

```matlab
f = linspace(-Fs/2, Fs/2, N);
H_freq = fftshift(fft(H_noisy, [], 2), 2);
 % 此处略去至少10行代码

zlabel('幅值');
title('信道传递函数 (频率, 幅值)');
```

**说明：**  

    - 利用 FFT 将时域信道响应转换到频率域，再使用 `fftshift` 使直流分量居中，最后绘制成三维网格图展示频率响应。
3. **统计直方图绘制**  

```matlab
tap_index = 1;  % 选择第一个抽头
subplot(2, 2, 3);
histogram(abs(H_noisy(tap_index, :)), 50);
xlabel('幅值');
ylabel('频数');
title(['单抽头信道系数直方图 (抽头', num2str(tap_index), ')']);
```

**说明：**  

    - 选取某一抽头，对其信道系数幅值数据进行统计，利用直方图展示其分布情况，便于观察随机特性。

---

![](https://i-blog.csdnimg.cn/direct/dafa38b69c8044b2a9149eeb34ddfdcf.png)

### 2.4 参数调整后的信道响应对比
```matlab
% 改变参数并重新绘制图形以观察变化
delay_new = [0, 0.5e-6, 1e-6, 1.5e-6, 2e-6];
power_new = [0, -6, -12, -18, -24];

H_new = zeros(length(delay_new), N);
for i = 1:length(delay_new)
    % 此处略去至少10行代码
```

**说明：**

+ 为了观察不同信道参数对仿真结果的影响，这里采用新的延迟和功率参数重新生成信道系数矩阵。
+ 随后同样进行噪声加入，并绘制新的时域响应图，与之前图形进行直观对比。

---

### 2.5 数据保存
```matlab
% 保存数据到文件
save('channel_model.mat', 'H', 'H_noisy', 'H_new', 'H_noisy_new');
```

**说明：**

+ 将原始信道矩阵和修改参数后的信道矩阵（包括带噪数据）保存到 MAT 文件中，方便后续的数据分析或进一步仿真验证。





![](https://i-blog.csdnimg.cn/direct/33e83c00cbc1469ab9e63c6c7267a666.png)  
![](https://i-blog.csdnimg.cn/direct/80bb738c6bae42a6a5e1eb7387c132e6.png)

