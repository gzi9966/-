

---

> # Python商业公司贸易业务数据分析可视化（数据+源码）【独一无二】
> @[TOC](目录)
>

---



---

# 1. 数据分析
提供的数据包含了关于不同城市的商业指标，这些指标反映了商业公司在各城市的运营情况和业绩表现。

1. **销售额**：表示商业公司在各个城市的销售额，是衡量公司业务收入的重要指标，直接反映了公司的市场销售情况和业务规模。
2. **利润**：表示商业公司在各个城市的利润额，是销售额扣除成本后的净收入，反映了公司的盈利能力和经营状况。
3. **订单量**：表示商业公司在各个城市的订单数量，是衡量公司业务活跃度和市场需求的重要指标，直接关系到销售额和利润的增长。
4. **客户数量**：表示商业公司在各个城市的客户数量，反映了公司在不同城市的市场渗透能力和客户群体规模，对业务发展和市场拓展具有重要影响。
5. **满意度**：表示客户对商业公司提供的服务或产品的满意程度，是衡量客户忠诚度和品牌形象的关键指标，对公司的市场声誉和长期发展具有重要影响。
6. **退货率**：表示商业公司在各个城市的退货比例，是衡量产品质量和服务水平的重要指标，高退货率可能会影响公司的盈利能力和客户信任度。
7. **市场份额**：表示商业公司在各个城市所占的市场份额，是衡量公司在行业中竞争地位和市场地位的重要指标，对于制定营销策略和竞争战略具有重要参考价值。

综合而言，这些指标能够全面地反映商业公司在不同城市的运营情况和市场表现，对于公司的业务决策、市场战略制定以及产品服务优化具有重要的参考意义。通过对这些指标的分析和监控，公司可以及时调整策略，优化资源配置，提升市场竞争力，实现持续健康发展。

---

![](https://cdn.nlark.com/yuque/0/2025/png/26188759/1742034512405-be6d5804-07e2-434f-9c69-ec0ef4a0924a.png)

# 2. 代码分析
## 2.1.1 模块导入
首先，我们来详细分析数据导入与处理部分的代码块：

```python
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns  # 用于更美观地绘制箱线图
plt.rcParams['font.sans-serif'] = ['SimHei']
from pyecharts import options as opts
from pyecharts.charts import Map

# 从Excel文件读取数据
df = pd.read_excel('商业公司数据.xlsx', engine='openpyxl')
```

1. **导入库**：该部分代码导入了所需的库，包括 `pandas`、`matplotlib`、`seaborn` 和 `pyecharts`。这些库在数据处理和可视化中都有其特定的作用。
2. **读取Excel数据**：使用 `pd.read_excel()` 函数从名为“商业公司数据.xlsx”的Excel文件中读取数据，并将其保存在名为 `df` 的 DataFrame 中。需要注意的是，`engine='openpyxl'` 参数指定了使用 `openpyxl` 引擎来读取Excel文件，这是 `pandas` 中用于处理Excel文件的一种常用方式。

这段代码的作用是将Excel文件中的数据读取到DataFrame中，为后续的数据分析和可视化准备好数据源。

---

![](https://cdn.nlark.com/yuque/0/2025/png/26188759/1742034512405-be6d5804-07e2-434f-9c69-ec0ef4a0924a.png)

## 2.1.2 多重堆叠柱状图绘制
在代码中绘制多重堆叠柱状图的部分对于数据分析有着重要的意义：

1. **数据对比**：通过多重堆叠柱状图，可以直观地比较不同城市在多个指标上的表现。每个柱子代表一个城市，在不同的指标上堆叠显示，使得比较城市之间的差异变得更加容易。
2. **指标分布**：堆叠柱状图将各个指标在每个城市的分布情况清晰地展示出来，有助于分析不同城市在销售额、利润、订单量等指标上的分布情况，以及这些指标之间的关系。
3. **趋势观察**：通过观察堆叠柱状图中不同指标的堆叠情况，可以发现某些城市在某些指标上表现突出，或者某些指标之间存在特定的关联趋势，这有助于进一步分析和了解数据的特点和规律。
4. **决策支持**：基于多重堆叠柱状图的分析，决策者可以更好地制定商业策略和业务发展方向。比如，可以根据柱状图的结果调整不同城市的市场策略，优化资源配置，提升业务效率和盈利能力。

因此，多重堆叠柱状图是一种强大的数据可视化工具，可以帮助分析人员从多个角度深入理解数据，并基于此做出更加明智的决策。

![](https://i-blog.csdnimg.cn/blog_migrate/a75284fe97a245e1e7aa1720123b1016.png)

---

![](https://cdn.nlark.com/yuque/0/2025/png/26188759/1742034512405-be6d5804-07e2-434f-9c69-ec0ef4a0924a.png)

## 2.1.2 柱状图和折线图组合的绘制
柱状图和折线图组合的绘制在数据分析中有着重要的意义，结合代码来分析：

1. **多维度展示**：通过柱状图和折线图的组合，可以同时展示不同指标在相同城市或相同指标在不同城市之间的变化趋势。柱状图一般用来表示数量或者金额等离散型数据，而折线图则更适合展示数据的趋势和变化。
2. **指标关联性分析**：柱状图和折线图的组合能够直观地展示出不同指标之间的关联性。通过观察柱状图和折线图的趋势，可以判断不同指标之间是否存在相关性或者趋势一致性，这有助于深入理解数据背后的规律。
3. **对比分析**：将柱状图和折线图放在同一画布上，可以更方便地进行对比分析。通过观察不同城市或者不同指标在柱状图和折线图上的表现，可以快速比较它们之间的差异和变化趋势，为业务决策提供有力支持。
4. **趋势观察**：折线图能够清晰地展示出数据的趋势，而柱状图则可以显示出具体的数值。通过柱状图和折线图的组合，可以直观地观察到销售额、利润等指标随时间或者城市的变化趋势，帮助企业进行长期的业务规划和战略调整。

因此，柱状图和折线图的组合是一种有效的数据可视化手段，能够帮助分析人员更深入地理解数据，并从中发现规律、趋势和关联性，为业务决策提供重要参考。

![](https://i-blog.csdnimg.cn/blog_migrate/95d7f773c8ef5a0403ae7e83c8feb907.png)

![](https://cdn.nlark.com/yuque/0/2025/png/26188759/1742034512405-be6d5804-07e2-434f-9c69-ec0ef4a0924a.png)

---

## 2.1.3 柱状图和折线图组合的绘制
多个子图的绘制在数据分析中有着重要的意义，结合代码来分析：

1. **多样化展示**：通过创建包含多个子图的画布，可以将不同类型的图表放置在同一个页面上，从而更全面地展示数据的多个方面。在本代码中，散点图、柱状图、折线图和饼图都被用来展示不同类型的数据特征，这种多样化的展示方式有助于深入理解数据。
2. **比较分析**：在每个子图中绘制不同类型的图表，可以方便地进行比较分析。例如，散点图用于展示销售额和利润之间的关系，柱状图用于展示各城市的销售额分布，折线图用于展示利润和订单量的趋势，饼图用于展示各城市的市场份额，通过比较这些图表可以更全面地了解数据。
3. **趋势观察**：折线图和柱状图可以用来观察数据的趋势和分布情况，从而发现数据的规律和特点。这有助于分析人员更好地了解数据背后的变化趋势和关联性，为业务决策提供支持。
4. **布局调整**：调用 `plt.tight_layout()` 函数可以自动调整子图的布局，避免图表重叠，使得整个页面更加美观和易读。



通过多个子图的绘制，可以从不同的角度全面地展示数据，帮助分析人员更深入地理解数据，并从中提取有价值的信息，为业务决策提供重要参考。



```python

# 设置图形大小
fig, axes = plt.subplots(nrows=2, ncols=2, figsize=(15, 12))

# 散点图
scatter = axes[0, 0].scatter(df['销售额'], df['利润'], c=df['订单量'], cmap='viridis', s=df['客户数量']*10, alpha=0.7, edgecolors='w')
cbar = fig.colorbar(scatter, ax=axes[0, 0])
cbar.set_label('订单量')
axes[0, 0].set_xlabel('销售额')
axes[0, 0].set_ylabel('利润')
axes[0, 0].set_title('销售额与利润的散点图')

# 柱状图
axes[0, 1].bar(df['城市'], df['销售额'], color='blue')
axes[0, 1].set_xlabel('城市')
axes[0, 1].set_ylabel('销售额')
axes[0, 1].set_title('各城市销售额分布')

# 折线图
axes[1, 0].plot(df['城市'], df['利润'], marker='o', label='利润')
axes[1, 0].plot(df['城市'], df['订单量'], marker='o', label='订单量')
axes[1, 0].set_xlabel('城市')
axes[1, 0].set_ylabel('数值')
axes[1, 0].set_title('利润和订单量趋势')
axes[1, 0].legend()

# 饼图
axes[1, 1].pie(df['市场份额'], labels=df['城市'], autopct='%1.1f%%', startangle=140)
axes[1, 1].set_title('各城市市场份额')

# 调整布局
plt.tight_layout()

# 显示图形
plt.show()

```

![](https://cdn.nlark.com/yuque/0/2025/png/26188759/1742034512405-be6d5804-07e2-434f-9c69-ec0ef4a0924a.png)

![](https://i-blog.csdnimg.cn/blog_migrate/da21e6c7dd0b56ee871ab11f729c1430.png)



## 2.1.3 销售额地区统计组合图绘制
销售额地区统计组合图的绘制在数据分析中有着重要的意义，结合代码来分析：

1. **箱线图的分析**：
    - 箱线图能够直观地展示销售额的分布情况，包括中位数、四分位数、异常值等统计信息。
    - 通过箱线图，可以清楚地了解不同城市销售额的分布范围、集中程度以及可能存在的异常情况，这有助于识别潜在的业务问题或者市场机会。
2. **折线图的分析**：
    - 在箱线图的基础上，通过第二个y轴绘制城市销售额的折线图，可以更直观地观察销售额随着城市变化的趋势。
    - 折线图能够显示销售额的变化趋势，帮助分析人员发现不同城市之间的销售额差异以及可能存在的市场趋势。
3. **趋势分析**：
    - 结合箱线图和折线图，可以进行销售额的趋势分析。通过观察折线图的趋势，可以发现销售额是否存在季节性、周期性或者整体趋势，从而为未来的销售策略提供参考。
    - 同时，通过对比不同城市的销售额箱线图和折线图，可以发现不同城市之间的销售情况是否存在差异，有助于制定针对性的销售策略。
4. **决策支持**：
    - 销售额地区统计组合图能够为决策者提供直观的数据参考，帮助他们更好地了解销售情况和市场趋势，从而制定更有效的业务发展策略和市场推广计划。

因此，销售额地区统计组合图通过结合箱线图和折线图的方式，能够全面展示销售额的分布情况和变化趋势，为业务分析和决策提供重要支持。

```python
# 设置图形大小
fig, ax1 = plt.subplots(figsize=(10, 6))

# 绘制箱线图
boxplot = df.boxplot(column=['销售额', '利润', '订单量', '客户数量', '满意度', '退货率', '市场份额'], ax=ax1)
ax1.set_ylabel('值')

# 添加折线柱状图
ax2 = ax1.twinx()
df.plot(x='城市', y='销售额', kind='line', marker='o', ax=ax2, color='r', label='销售额')
ax2.set_ylabel('销售额')

# 设置x轴标签
ax1.set_xticks(range(1, len(df['城市']) + 1))
ax1.set_xticklabels(df['城市'])

# 显示图例
lines, labels = ax1.get_legend_handles_labels()
lines2, labels2 = ax2.get_legend_handles_labels()
ax2.legend(lines + lines2, labels + labels2, loc='upper left')

# 设置标题
plt.title('销售额地区统计组合图')

# 显示图形
plt.show()
```

![](https://i-blog.csdnimg.cn/blog_migrate/423b10d3e3aaa0914bee231fb7225e01.png)

![](https://cdn.nlark.com/yuque/0/2025/png/26188759/1742034512405-be6d5804-07e2-434f-9c69-ec0ef4a0924a.png)

